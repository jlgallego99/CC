# Elección de framework y biblioteca para realizar tests en el proyecto con Go: Ginkgo
En este documento se describe el estudio que se ha llevado para elegir el framework y biblioteca de aserciones que se usarán a lo largo de todo el proyecto, siendo estas para el lenguaje Go. Su objetivo es dar la capacidad de testear todo el código que se realice, y saber que cuando una funcionalidad desarrollada pasa sus tests se puede dar por completada (y por tanto, cerrar su issue).

Go es un caso especial a diferencia de otros lenguajes ya que el propio lenguaje incluye un framework y biblioteca de test básicos mediante la utilidad [**go test**](https://pkg.go.dev/cmd/go#hdr-Test_packages) y el [**paquete Testing**](https://pkg.go.dev/testing), que permite realizar tests pero sin aserciones, si no controlando errores. Al ser parte del lenguaje, tenemos un método oficial para realizar tests, que además nos asegura que usa buenas prácticas dentro del lenguaje y que estará bien soportado en el tiempo, es simple y se pueden encontrar multitud de recursos para su uso debido a su popularidad. Sin embargo se queda corta y no da mucha versatilidad, es por esto que gran parte de las bibliotecas de aserciones y frameworks que podemos encontrar se centran en ayudar a la biblioteca estándar de varias maneras. Debido a esto, al usar una de estas bibliotecas o frameworks adicionales, a la vez se aprenderá también a usar el propio de Go, por lo que no se descarta por completo su uso.

Existen dos maneras de testear el proyecto, basándose en los propios tests (TDD) o en comportamientos (BDD). Para este proyecto me gustaría optar por el estilo BDD, ya que es el estilo que he usado en el pasado al testear (con Mocha y Chai, por ejemplo) y permiten tener unos tests más legibles, que faciliten mucho el hacerlos y comprobarlos, que se centren en el comportamiento de las funcionalidades que se evaluan, y por tanto tener una correlación más directa con las historias de usuario y la lógica de negocio.

Se han estudiado distintas bibliotecas para poder elegir la más adecuada tanto para este proyecto como para aprender bien a realizar tests en este lenguaje. De entre ellas, se ha elegido usar [**Ginkgo**](https://github.com/onsi/ginkgo). Es uno de los frameworks de testing BDD más populares de Go y sigue teniendo bastante soporte, proporciona además herramientas de cobertura de código y su propia utilidad para ejecutar los tests, aunque funciona también con la propia del lenguaje. Además da una salida de los tests más bonita y legible ya que usa colores. Tiene una utilidad que te genera un esqueleto de test a partir de cada paquete, para mayor rapidez y facilidad. Pese a que se puede usar por sí sola, ellos mismos recomiendan usarla junto a la biblioteca [Gomega](https://onsi.github.io/gomega/), la cual proporciona aserciones muy legibles que además se les puede añadir anotaciones para especificar bien qué hace cada una, y permite un buen manejo de errores al estilo Go. 

Me gusta porque se pueden crear varios tests sobre un mismo tema y que estén dentro de este, haciendolo mas legible. Es el framework que usaría para un proyecto grande ya que es muy completo y aprenderlo bien implicaría tener unos tests muy buenos, sin embargo tiene una capa de complejidad adicional el tener que usar dos bibliotecas y demasiadas opciones. He decidido usarlo aún así debido a que a largo plazo puede ser muy positivo saber usarla bien, tiene muy buena y extensa documentación, permite entender bien los tests al escribirlos y leerlos y da una salida legible, con colores y que permite comprobar bien lo que se ha testeado. Se parece en ciertas cosas a Mocha y Chai, que he usado en el pasado, y en el caso de que necesitase mayor complejidad podría integrarla con Gomega. Usaré tanto el framework como la propia biblioteca de aserciones que ofrece, para tener la experiencia más cercana a la que buscan sus desarrolladores, y los tests los ejecutaré usando la propia utilidad de Go que es más que simple y suficiente.

Pese a que se ha elegido de antemano usar un estilo BDD, también se han estudiado bibliotecas del estilo TDD para una mejor comprensión del panorama actual. En todas ellas los tests se ejecutan usando *go test*, la propia utilidad del lenguaje. A continuación se describen el resto de bibliotecas que se han investigado:

- [Testify](https://github.com/stretchr/testify): Es las más famosa de las bibliotecas de aserciones en Go para TDD testing, tiene mocks y aserciones más complejas para poder hacer distintos tipos de tests. Se usa generalmente junto a la biblioteca estándar y los tests se ejecutan con la propia utilidad del lenguaje.
- [Gocheck](https://github.com/go-check/check): Otra biblioteca de aserciones TDD, alternativa a testify que permite aserciones más completas. Sin embargo el proyecto parece un tanto abandonado, ya que su último commit es de hace un año, pero realmente recibe solo uno o dos commits al año.
- [Gopowt](https://github.com/ToQoz/gopwt): Esta biblioteca ofrece aserciones sencillas TDD y es bastante interesante puesto que sirve para identificar en qué parte del código se ha producido el fallo de un test, poniendolo como parte del mensaje de los tests. Sin embargo, al igual que la anterior no es muy popular y se puede considerar abandonada puesto que lleva sin actualizarse desde 2019, lo cual es decisivo a la hora de elegir con qué hacer los tests y más aún en un lenguaje en auge y que va evolucionando en el tiempo como Go.
- [Goconvey](https://github.com/smartystreets/goconvey): Es de las bibliotecas de aserciones BDD más populares de Go. Ofrece una gran cantidad de opciones para realizar los tests, entre ellas aserciones customizadas, lo cual hace que sea bastante complejo. Los tests dan una salida en terminal con colores para que sea más legible. Lo más interesante es que también se pueden mostrar los resultados de los tests en una interfaz web con todo lujo de detalles, sin embargo no es necesario y en general esta biblioteca ofrece demasiadas opciones, por lo que queda demasiado grande y complejo para este proyecto.
- [**Goblin**](https://github.com/franela/goblin): Es una biblioteca de aserciones BDD con cierta popularidad y soporte continuado. Es bastante parecida a la anterior y también da una salida de consola con color, indicando además donde está el error del test y cuales son los valores que han entrado en juego. Los tests se ejecutan usando la propia utilidad del lenguaje, *go test*, por lo que no hace falta instalar nada más y basta con importar el paquete para ponerse a funcionar. Sin embargo es demasiado simple incluso para un proyecto pequeño/mediano y no tiene mucha documentacion o ayuda.