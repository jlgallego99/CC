# Frameworks web para Go: Gin
En este documento se describe el estudio realizado a la hora de elegir un framework web para poder crear un API REST en Go de la mejor forma posible. Para ello se han analizado los más usados y conocidos (ya sea por número de usuarios que lo usan o por estrellas en Github). Hay que tener en cuenta que Go incluye en la biblioteca estándar toda la funcionalidad necesaria para tratar con HTTP y crear un API REST, sin embargo usar un framework nos ayudará a hacerlo de forma más rápida, sencilla y seguramente mejor, lo cual es lo más adecuado para un proyecto de esta escala.

De entre todos los frameworks estudiados se ha elegido usar **Gin**, por las razones que se explicarán a continuación, sin embargo también se presentan las características principales de los otros que se han estudiado para poder comparar bien.

[Gin](https://github.com/gin-gonic/gin) es actualmente el framework más famoso y utilizado en Go por bastante diferencia con el resto, es por esto que es fácil encontrar ayuda online además de la extensa documentación que tiene, además de que se considera fácil para principiantes. Es un framework rápido, algo deseable en un lenguaje también rápido como es el propio Go, con una buena forma de manejar los errores en el propio framework y que proporciona soporte para middlewares, algo que era necesario buscar puesto que hay que añadir un logger en el proyecto y este lo permite. Por último, uno de sus puntos más positivos es que facilita la validación y parseo del JSON, algo bastante útil sobre todo en Go, ya que en el pasado he tenido dificultades para tratar con objectos JSON de forma estándar, y esto es algo que se va a usar mucho en un API REST. Por todo esto se ha elegido usar Gin, así al aprender bien a usar el framework más usado en este lenguaje tendré menos problemas en el futuro cuando quiera crear un API REST con Go, ya que tendré una herramienta buena, muy usada y con soporte.  
Programar con este framework es muy simple porque con pocas líneas se puede definir el middleware para logs y las rutas, las rutas se pueden agrupar en subrutas, se puede exportar fácilmente el objeto del framework para luego usarlo para testearlo, etc.

- [Beego](https://github.com/beego/beego) es el segundo framework más famoso, aunque bastante por debajo de Gin. Es rápido y viene con middleware para logging y bases de datos, por lo que también habría sido una buena opción y me planteo investigarlo más en el futuro. Sin embargo, al ser bastante flexible y que su documentación creo que es complicada y extensa, requeriría bastante tiempo aprenderlo bien.
- [Echo](https://github.com/labstack/echo) es otro de los frameworks más famosos en Go, que se define a si mismo como minimalista y eficiente. Permite tratar con objetos JSON y es extensible mediante distintos middleware. Sin embargo estos middleware tienen una documentación demasiado escasa, sobre todo para el logger que es el que nos interesa y no permite integrarlo con otros logger que podrían ser mejores. En general es parecido a los otros vistos y creo que no aporta demasiado, pero no por ello es una opción menos sólida.
- [Gorilla/Mux](https://github.com/gorilla/mux) es un framework no tan famoso pero muy usado, compatible con la biblioteca HTTP estándar y que permite hacer subrutas que sólamente funcionen cuando la ruta padre sea correcta, lo cual aporta versatilidad a la hora de diseñar la API. Es bastante simple de usar, permite añadir middleware de distinto tipo y también está pensado para servir Single Pages Application, aunque esto no es un objetivo del proyecto. En general es de los mejores por su simplicidad y versatilidad, por lo que también sería una opción buena, sin embargo el no ser tan popular y no tener una página dedicada a su documentación que me permita explorarlo más en profundidad hacen que no lo escoja pero lo tenga en cuenta para el futuro. 
- [Martini](https://github.com/go-martini/martini) es un framework simple que proporciona una funcionalidad básica extensible mediante servicios de terceros. Esta extensibilidad hace que no quiera escogerlo tanto porque es algo que se puede complicar mucho, y puesto que necesitamos JSON y logs habría que ver cual es el mejor middleware para ello ya que nada de esto viene de base. Además lleva abandonado muchos años por lo que no tiene ningún tipo de soporte y es un framework que he usado en el pasado y me pareció algo complicado de entender ya que hace mucho trabajo por debajo. Esta gran abstracción hace que sea difícil entender como funciona.

## Testing para el API REST
Puesto que se tienen nuevos artefactos de código con la entrada de un framework para el API REST, es necesario testear ese nuevo código mediante una serie de tests de integración, en los cuales se testeará que las distintas rutas definidas funcionan correctamente y como se espera.

Para esto el propio framework que se ha elegido, Gin, nos explica como [testear un API REST usando este framework](https://github.com/gin-gonic/gin#testing), usando el paquete *net/http/httptest*, que es parte del lenguaje. Con esto, ya bastaría para poder realizar los tests necesarios, sin embargo, este proyecto ya estaba usando una biblioteca para tests: Ginkgo junto con Gomega, y esta última ofrece [funcionalidad que amplía este paquete de tests del lenguaje](https://onsi.github.io/gomega/#ghttp-testing-http-clients), dando una forma más sencilla, efectiva y cercana al resto de tests unitarios hechos con esta herramienta, por lo que tiene sentido seguir usando esta biblioteca que ya se estaba usando.